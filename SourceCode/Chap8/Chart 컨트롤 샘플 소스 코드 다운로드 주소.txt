http://code.msdn.microsoft.com/Samples-Environments-for-b01e9c61